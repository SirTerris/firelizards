<!DOCTYPE html>
<html>
<head>
  <title>Firelizard Breeder v1</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .fl-box { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }
    label { display: block; margin-top: 10px; }
    pre { background: #f4f4f4; padding: 10px; }
    input.rename-input { margin-left: 10px; }
    textarea { width: 100%; height: 100px; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>üî• Firelizard Breeder</h1>
  <nav>
    <button onclick="showTab('adoptTab')">Adopt</button>
    <button onclick="showTab('listTab')">Your Firelizards</button>
    <button onclick="showTab('breedTab')">Breed</button>
    <button onclick="showTab('showTab')">Show</button>
    <button onclick="showTab('geneTab')">Gene Testing</button>
    <button onclick="showTab('resetTab')">Reset</button>
  $1
    <button onclick="showTab('phenotypeTab')">Phenotype Checklist</button>
  <h1>üî• Firelizard Breeder</h1>

  <div class="fl-box" id="adoptTab" style="display: block;">
    <h2>Adopt a Firelizard</h2>
    <button onclick="showAdoptionOptions()">See Available Firelizards</button>
    <div id="adoptionArea"></div>
    <pre id="flDisplay"></pre>
  </div>

  <div class="fl-box" id="listTab" style="display: none;">
    <h2>Your Firelizards</h2>
    <button onclick="saveFirelizards()">üíæ Save</button>
    <button onclick="loadFirelizards()">üìÇ Load</button>
    <button onclick="exportFirelizards()">‚¨áÔ∏è Export</button>
    <button onclick="importFirelizards()">‚¨ÜÔ∏è Import</button>
    <textarea id="dataArea" placeholder="Copy/exported data here or paste to import..."></textarea>
    <ul id="flList"></ul>
  <label for="exportSelect">Select Firelizard to Export:</label>
    <select id="exportSelect"></select>
    <button onclick="exportSingleFirelizard()">üì§ Export Selected Firelizard</button>
    <button onclick="importSingleFirelizard()">üì• Import One</button>
</div>

  
<style>
  .filter-buttons button { margin: 2px; }
</style>

$1
    <div class="filter-buttons">
      <button onclick="filterPhenotypes('all')">Show All</button>
      <button onclick="filterPhenotypes('pale')">Only Pale</button>
      <button onclick="filterPhenotypes('metallic')">Only Metallic</button>
      <button onclick="filterPhenotypes('standard')">Standard</button>
    </div>
    <p><strong>Completed:</strong> <span id="phenotypeCount">0</span> / <span id="phenotypeTotal">0</span></p>
    <h2>Phenotype Checklist</h2>
    <ul id="phenotypeList"></ul>
  </div>

$1 style="display: none;">
    <h2>Breed Firelizards</h2>
    <label for="parent1">Select Parent 1:</label>
    <select id="parent1"></select>
    <label for="parent2">Select Parent 2:</label>
    <select id="parent2"></select>
    <button onclick="breedFirelizards()">Breed</button>
    <pre id="offspringDisplay"></pre>
  </div>

  <div class="fl-box" id="showTab" style="display: none;">
    <h2>Show Your Firelizard</h2>
    <label for="showSelect">Select Firelizard:</label>
    <select id="showSelect"></select>
    <button onclick="showFirelizard()">Enter Show</button>
    <pre id="showResult"></pre>
    <p><strong>Prettyshinies:</strong> <span id="prettyshinies">0</span></p>
  </div>

  <div class="fl-box" id="geneTab" style="display: none;">
    <h2>Gene Testing Lab</h2>
    <label for="testSelect">Select Firelizard:</label>
    <select id="testSelect"></select>
    <button onclick="geneTestFirelizard()">Test Genes (5000 Prettyshinies)</button>
    <pre id="geneTestResult"></pre>
  </div>

  <div class="fl-box" id="resetTab" style="display: none;">
    <h2>Reset Game</h2>
    <button onclick="resetGame()">‚ö†Ô∏è Reset All Progress</button>
    <p><em>This will delete all firelizards and Prettyshinies permanently.</em></p>
  </div>

  <script>
    let firelizards = [];
let prettyshinies = 0;

    function getRandomAllele(alleles) {
      return alleles[Math.floor(Math.random() * alleles.length)];
    }

    function generateRandomGenes() {
      const genePool = {
        b: ['B', 'b'], g: ['G', 'g'], d: ['d', 'D'], m: ['m', 'M'], p: ['P', 'p'],
        a: ['A', 'a'], prl: ['prl', 'PRL'], z: ['z', 'Z'], tg: ['tg', 'TG'],
        mo: ['mo', 'MO'], u: ['u', 'U'], po: ['po', 'PO'], sp: ['sp', 'SP']
      };
      let genes = {};
      for (let key in genePool) {
        genes[key] = [getRandomAllele(genePool[key]), getRandomAllele(genePool[key])];
      }
      return genes;
    }

    function generateStats() {
      return {
        Strength: Math.floor(Math.random() * 10) + 1,
        Intelligence: Math.floor(Math.random() * 10) + 1,
        Wisdom: Math.floor(Math.random() * 10) + 1,
        Charisma: Math.floor(Math.random() * 10) + 1,
        Dexterity: Math.floor(Math.random() * 10) + 1,
        Constitution: Math.floor(Math.random() * 10) + 1
      };
    }

    function statsToString(stats) {
      return Object.entries(stats).map(([k, v]) => {
        let color = '';
        if (typeof v === 'object' && v.hasOwnProperty('value')) {
          if (v.mutation > 0) color = ' style="color: green"';
          else if (v.mutation < 0) color = ' style="color: red"';
          return `<span${color}>${k}: ${v.value}</span>`;
        }
        return `${k}: ${v}`;
      }).join(', ');
    }

    function getAppearance(genes) {
  const [B1, B2] = genes.b || [];
  const isBrown = B1 === 'B' || B2 === 'B';
  const [G1, G2] = genes.g || [];
  const [D1, D2] = genes.d || [];
  const [M1, M2] = genes.m || [];
  const [P1, P2] = genes.p || [];
  const [A1, A2] = genes.a || [];

  let baseColor = 'Unknown';
  if (isBrown) baseColor = 'Brown';
  else {
    const green = G1 === 'G' || G2 === 'G';
    const red = G1 === 'g' && G2 === 'g';
    const dilute = D1 === 'd' && D2 === 'd';
    if (green) baseColor = dilute ? 'Blue' : 'Green';
    else if (red) baseColor = dilute ? 'Yellow' : 'Red';
  }

  const metallic = M1 === 'm' && M2 === 'm';
  let sex = Math.random() < 0.5 ? 'Male' : 'Female';
  if (metallic) {
    if (baseColor === 'Green') baseColor = sex === 'Male' ? 'Tarnished Bronze' : 'Tarnished Gold';
    else if (baseColor === 'Red') baseColor = sex === 'Male' ? 'Copper' : 'Rose Gold';
    else if (baseColor === 'Blue') baseColor = sex === 'Male' ? 'Chrome' : 'Silver';
    else if (baseColor === 'Yellow') baseColor = sex === 'Male' ? 'Copper' : 'Rose Gold';
    else baseColor = sex === 'Male' ? 'Bronze' : 'Gold';
  }

  const melanistic = P1 === 'P' || P2 === 'P';
  const doubleMelanistic = P1 === 'P' && P2 === 'P';
  if (doubleMelanistic) baseColor = 'Black';

  const albino = A1 === 'A' || A2 === 'A';
  const doubleAlbino = A1 === 'A' && A2 === 'A';
  if (doubleAlbino) baseColor = 'White';
  else if (albino) baseColor = 'Pale ' + baseColor;

  let markings = [];
  if (genes.mo && genes.mo[0] === 'mo' && genes.mo[1] === 'mo') markings.push('Mottled');
  if (genes.tg && genes.tg[0] === 'tg' && genes.tg[1] === 'tg') markings.push('Striped');
  if (genes.sp && genes.sp[0] === 'sp' && genes.sp[1] === 'sp') markings.push('Spotted');

  const markingString = markings.length ? ` + ${markings.join(' + ')}` : '';
  return `${sex} ${baseColor}${markingString}`;
}
    }

    function generateRandomFirelizard(name, genes, stats, cost = 0) {
      if (firelizards.length > 0 && prettyshinies < cost) {
        document.getElementById('flDisplay').textContent = `You need ${cost} Prettyshinies to adopt this firelizard.`;
        return;
      }
      if (cost > 0) prettyshinies -= cost;

      const appearance = getAppearance(genes);
      const id = firelizards.length;
      firelizards.push({ id, name, genes, appearance, stats, shows: 0 });
      updateFirelizardList();
  updatePhenotypeChecklist();
      document.getElementById('flDisplay').textContent = `You adopted ${name}: ${appearance}
${statsToString(stats)}`;
      document.getElementById('prettyshinies').textContent = prettyshinies;
      saveFirelizards();
    }

    function updateFirelizardList() {
      const flList = document.getElementById('flList');
      const parent1 = document.getElementById('parent1');
      const parent2 = document.getElementById('parent2');
      const showSelect = document.getElementById('showSelect');
      const testSelect = document.getElementById('testSelect');
      const exportSelect = document.getElementById('exportSelect');

      flList.innerHTML = '';
      parent1.innerHTML = '';
      parent2.innerHTML = '';
      showSelect.innerHTML = '';
      testSelect.innerHTML = '';
      exportSelect.innerHTML = '';

      firelizards.forEach(fl => {
        const li = document.createElement('li');
        li.innerHTML = `<strong>${fl.name}</strong>: ${fl.appearance}<br>${statsToString(fl.stats)}<br>Shows Entered: ${fl.shows}<br><input class="rename-input" type="text" placeholder="Rename" onchange="renameFirelizard(${fl.id}, this.value)"> <button onclick="deleteFirelizard(${fl.id})">‚ùå Delete</button>`;
        flList.appendChild(li);

        const option1 = document.createElement('option');
        option1.value = fl.id;
        option1.textContent = `${fl.name} (${fl.appearance})`;
        parent1.appendChild(option1);

        const option2 = document.createElement('option');
        option2.value = fl.id;
        option2.textContent = `${fl.name} (${fl.appearance})`;
        parent2.appendChild(option2);
        const option3 = document.createElement('option');
        option3.value = fl.id;
        option3.textContent = `${fl.name} (${fl.appearance})`;
        showSelect.appendChild(option3);
        const option4 = document.createElement('option');
        option4.value = fl.id;
        option4.textContent = `${fl.name} (${fl.appearance})`;
        testSelect.appendChild(option4);
        const option5 = document.createElement('option');
        option5.value = fl.id;
        option5.textContent = `${fl.name} (${fl.appearance})`;
        exportSelect.appendChild(option5);
      });
    }

    function renameFirelizard(id, newName) {
      if (firelizards[id]) {
        firelizards[id].name = newName || firelizards[id].name;
        updateFirelizardList();
        saveFirelizards();
      }
    }

    function breedFirelizards() {
      const id1 = parseInt(document.getElementById('parent1').value);
      const id2 = parseInt(document.getElementById('parent2').value);
      const p1 = firelizards[id1];
      const p2 = firelizards[id2];

      const sex1 = p1.appearance.split(' ')[0];
      const sex2 = p2.appearance.split(' ')[0];
      if (sex1 === sex2) {
        document.getElementById('offspringDisplay').textContent = `Breeding failed: Both firelizards are ${sex1}. Must be one male and one female.`;
        return;
      }

      // Inherit genes
      let childGenes = {};
      for (let key in p1.genes) {
        if (p2.genes[key]) {
          const a = p1.genes[key][Math.floor(Math.random() * 2)];
          const b = p2.genes[key][Math.floor(Math.random() * 2)];
          childGenes[key] = [a, b];
        }
      }

      const stats = {};
      const statKeys = ['Strength', 'Intelligence', 'Wisdom', 'Charisma', 'Dexterity', 'Constitution'];
      statKeys.forEach(key => {
        const combined = p1.stats[key] + p2.stats[key];
        const range = Math.floor(combined * 0.1);
        const min = Math.max(1, range);
        const max = Math.min(20, range * 2);
        let value = Math.floor(Math.random() * (max - min + 1)) + min;

        // 5% chance of a mutation: +/-1-3 points
        if (Math.random() < 0.05) {
          const mutation = Math.floor(Math.random() * 7) - 3; // range -3 to +3
          value = Math.min(20, Math.max(1, value + mutation));
        }

        stats[key] = { value: value, mutation: mutation || 0 };
      });
      const appearance = getAppearance(childGenes);
      const id = firelizards.length;
      const name = `Offspring ${id}`;
      firelizards.push({ id, name, genes: childGenes, appearance, stats });
      updateFirelizardList();
      document.getElementById('offspringDisplay').textContent = `A new firelizard was born: ${name} - ${appearance}\n${statsToString(stats)}`;
      saveFirelizards();
    }

    function saveFirelizards() {
      localStorage.setItem('firelizards', JSON.stringify(firelizards));
    }

    function loadFirelizards() {
      const data = localStorage.getItem('firelizards');
      if (data) {
        firelizards = JSON.parse(data);
        updateFirelizardList();
      }
    }

    function exportFirelizards() {
      const data = JSON.stringify(firelizards, null, 2);
      document.getElementById('dataArea').value = data;
    }

    function importFirelizards() {
      try {
        const input = document.getElementById('dataArea').value;
        const imported = JSON.parse(input);
        if (Array.isArray(imported)) {
          firelizards = imported;
          updateFirelizardList();
          saveFirelizards();
        }
      } catch (e) {
        alert('Invalid data format. Please paste valid JSON.');
      }
    }

    function showFirelizard() {
      const id = parseInt(document.getElementById('showSelect').value);
      const fl = firelizards[id];
      if (fl.shows >= 1000) {
        document.getElementById('showResult').textContent = `${fl.name} has reached the show limit of 1000 and cannot compete anymore.`;
        return;
      }
      fl.shows++;
      const statKeys = Object.keys(fl.stats);
      const statToImprove = statKeys[Math.floor(Math.random() * statKeys.length)];
      const increase = Math.floor(Math.random() * 2) + 1;
      if (typeof fl.stats[statToImprove] === 'object') fl.stats[statToImprove].value += increase;
      else fl.stats[statToImprove] += increase;
      const score = Object.values(fl.stats).reduce((a, b) => a + (typeof b === 'object' ? b.value : b), 0);
      const reward = Math.floor(score * 0.1);
      prettyshinies += reward;
      document.getElementById('showResult').textContent = `${fl.name} entered a show!
${statToImprove} increased by ${increase}.
Show score: ${score}, Prettyshinies earned: ${reward}`;
      document.getElementById('prettyshinies').textContent = prettyshinies;
      updateFirelizardList();
      saveFirelizards();
    }

    function showAdoptionOptions() {
      const container = document.getElementById('adoptionArea');
      container.innerHTML = '';

      for (let i = 0; i < 3; i++) {
        const genes = generateRandomGenes();
        const stats = generateStats();
        const appearance = getAppearance(genes);
        const score = Object.values(stats).reduce((a, b) => a + b, 0);
        const cost = firelizards.length === 0 ? 0 : 1000 + score * 20;
        const div = document.createElement('div');
        div.innerHTML = `
          <p><strong>${appearance}</strong><br>${statsToString(stats)}<br>Cost: ${cost} Prettyshinies</p>
          <input type="text" placeholder="Name this firelizard">
          <button onclick="adoptFromList(this, ${JSON.stringify(genes).replace(/"/g, '&quot;')}, ${JSON.stringify(stats).replace(/"/g, '&quot;')}, ${cost})">Adopt</button>
          <hr>`;
        container.appendChild(div);
      }
    }

    function adoptFromList(button, geneObj, statsObj, cost) {
      const name = button.previousElementSibling.value || 'Unnamed';
      generateRandomFirelizard(name, geneObj, statsObj, cost);
      document.getElementById('adoptionArea').innerHTML = '';
    }

    function geneTestFirelizard() {
      const id = parseInt(document.getElementById('testSelect').value);
      const fl = firelizards[id];
      const cost = 5000;
      if (prettyshinies < cost) {
        document.getElementById('geneTestResult').textContent = `Not enough Prettyshinies to perform test. (${cost} required)`;
        return;
      }
      prettyshinies -= cost;
      let geneString = Object.entries(fl.genes).map(([k, v]) => `${k.toUpperCase()}: ${v.join('/')}`).join(', ');
      document.getElementById('geneTestResult').textContent = `${fl.name}'s genes: ${geneString}`;
      document.getElementById('prettyshinies').textContent = prettyshinies;
      saveFirelizards();
    }

    function resetGame() {
      if (confirm('Are you sure you want to reset your game? This cannot be undone.')) {
        localStorage.removeItem('firelizards');
        firelizards = [];
        prettyshinies = 0;
        document.getElementById('prettyshinies').textContent = prettyshinies;
        updateFirelizardList();
        document.getElementById('flDisplay').textContent = '';
        document.getElementById('offspringDisplay').textContent = '';
        document.getElementById('showResult').textContent = '';
        document.getElementById('geneTestResult').textContent = '';
        document.getElementById('dataArea').value = '';
        document.getElementById('adoptionArea').innerHTML = '';
      }
    }

    function showTab(tabId) {
      const tabs = ['adoptTab', 'listTab', 'breedTab', 'showTab', 'geneTab', 'resetTab'];
      tabs.forEach(id => {
        document.getElementById(id).style.display = id === tabId ? 'block' : 'none';
      });
    }

    function exportSingleFirelizard() {
      const id = parseInt(document.getElementById('exportSelect').value);
      const fl = firelizards[id];
      if (!fl) return;
      const singleData = JSON.stringify(fl, null, 2);
      document.getElementById('dataArea').value = singleData;
    }

    function importSingleFirelizard() {
      try {
        const input = document.getElementById('dataArea').value;
        const imported = JSON.parse(input);
        if (imported && imported.name && imported.genes && imported.stats) {
          const id = firelizards.length;
          imported.id = id;
          imported.name = imported.name + ' (imported)';
          firelizards.push(imported);
          updateFirelizardList();
          saveFirelizards();
        }
      } catch (e) {
        alert('Invalid firelizard data.');
      }
    }

    function deleteFirelizard(id) {
      if (confirm('Are you sure you want to delete this firelizard?')) {
        firelizards.splice(id, 1);
        firelizards.forEach((fl, index) => fl.id = index);
        updateFirelizardList();
        saveFirelizards();
      }
    }

    const allPhenotypes = [
  'Male Brown', 'Female Brown',
  'Male Green', 'Female Green', 'Male Blue', 'Female Blue',
  'Male Red', 'Female Red', 'Male Yellow', 'Female Yellow',
  'Bronze', 'Gold',
  'Tarnished Bronze', 'Tarnished Gold',
  'Chrome', 'Silver',
  'Copper', 'Rose Gold',
  'Black', 'White', 'Pale Brown', 'Pale Green', 'Pale Blue', 'Pale Red', 'Pale Yellow',
  'Pale Bronze', 'Pale Gold', 'Pale Chrome', 'Pale Silver', 'Pale Copper', 'Pale Rose Gold',
  'Mottled', 'Striped', 'Spotted',
  'Mottled + Striped', 'Mottled + Spotted', 'Striped + Spotted',
  'Mottled + Striped + Spotted'
];

function updatePhenotypeChecklist() {
  const seen = new Set(firelizards.map(fl => fl.appearance));
  const list = document.getElementById('phenotypeList');
  const totalSpan = document.getElementById('phenotypeTotal');
  const countSpan = document.getElementById('phenotypeCount');

  let count = 0;
  list.innerHTML = '';
  allPhenotypes.forEach(pheno => {
    const hasSeen = seen.has(pheno);
    if (hasSeen) count++;
    const li = document.createElement('li');
    const checked = hasSeen ? '‚úÖ' : '‚¨ú';
    li.textContent = `${checked} ${pheno}`;
    li.dataset.pheno = pheno.toLowerCase();
    list.appendChild(li);
  });
  totalSpan.textContent = allPhenotypes.length;
  countSpan.textContent = count;
}
  list.innerHTML = '';
  allPhenotypes.forEach(pheno => {
    const li = document.createElement('li');
    const checked = seen.has(pheno) ? '‚úÖ' : '‚¨ú';
    li.textContent = `${checked} ${pheno}`;
    list.appendChild(li);
  });
}

function filterPhenotypes(type) {
  const items = document.querySelectorAll('#phenotypeList li');
  items.forEach(item => {
    const text = item.dataset.pheno;
    let show = false;
    if (type === 'all') show = true;
    else if (type === 'pale') show = text.includes('pale');
    else if (type === 'metallic') show = ['bronze', 'gold', 'chrome', 'silver', 'copper', 'rose gold'].some(m => text.includes(m));
    else if (type === 'standard') show = !text.includes('pale') && !['bronze', 'gold', 'chrome', 'silver', 'copper', 'rose gold'].some(m => text.includes(m));
    item.style.display = show ? '' : 'none';
  });
}

window.onload = function () {
      loadFirelizards();
      showTab('adoptTab');
    };
  </script>
</body>
</html>
